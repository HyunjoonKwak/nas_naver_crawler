# SGIS API ì„¤ì • ê°€ì´ë“œ

ì—­ì§€ì˜¤ì½”ë”© ê¸°ëŠ¥(ì¢Œí‘œ â†’ ë²•ì •ë™ ë³€í™˜)ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” SGIS API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.

## ðŸ”‘ API í‚¤ ë°œê¸‰ë°›ê¸°

### 1. SGIS í™ˆíŽ˜ì´ì§€ ì ‘ì†
https://sgis.kostat.go.kr/

### 2. íšŒì›ê°€ìž… ë° ë¡œê·¸ì¸
- ìš°ì¸¡ ìƒë‹¨ "ë¡œê·¸ì¸" í´ë¦­
- íšŒì›ê°€ìž… ì§„í–‰ (ì´ë©”ì¼ ì¸ì¦ í•„ìš”)

### 3. ì¸ì¦í‚¤ ì‹ ì²­
1. ë¡œê·¸ì¸ í›„ ìš°ì¸¡ ìƒë‹¨ "ë§ˆì´íŽ˜ì´ì§€" í´ë¦­
2. "ì¸ì¦í‚¤" ë©”ë‰´ í´ë¦­
3. "ì¸ì¦í‚¤ ì‹ ì²­" ë²„íŠ¼ í´ë¦­
4. ì„œë¹„ìŠ¤ ì •ë³´ ìž…ë ¥:
   - **ì„œë¹„ìŠ¤ëª…**: ë„¤ì´ë²„ ë¶€ë™ì‚° í¬ë¡¤ëŸ¬ (ìžìœ ë¡­ê²Œ ìž‘ì„±)
   - **ì„œë¹„ìŠ¤ URL**: http://localhost:3000 ë˜ëŠ” ì‹¤ì œ ë°°í¬ URL
   - **ì„œë¹„ìŠ¤ ì„¤ëª…**: ì•„íŒŒíŠ¸ ë‹¨ì§€ ë²•ì •ë™ ì •ë³´ ìˆ˜ì§‘ìš©
5. ì‹ ì²­ ì™„ë£Œ í›„ ì¦‰ì‹œ ë°œê¸‰ë¨

### 4. í‚¤ í™•ì¸
- **ì„œë¹„ìŠ¤ ID** (Consumer Key): ì˜ˆ) `1fda8e6202ad463d91aa`
- **ë³´ì•ˆí‚¤** (Consumer Secret): ì˜ˆ) `b2b879daf06c47e8b500`

---

## ðŸ”§ NAS ì„œë²„ ì„¤ì • ë°©ë²•

### ë°©ë²• 1: echoë¡œ í•œ ë²ˆì— ì¶”ê°€ (ê¶Œìž¥ â­)

SSHë¡œ NAS ì ‘ì† í›„ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°í•˜ì„¸ìš”:

```bash
cd /volume1/docker/nas_naver_crawler && cat >> .env << 'EOF'

# SGIS (í†µê³„ì§€ë¦¬ì •ë³´ì„œë¹„ìŠ¤) API - ì—­ì§€ì˜¤ì½”ë”©ìš©
SGIS_CONSUMER_KEY="YOUR_CONSUMER_KEY_HERE"
SGIS_CONSUMER_SECRET="YOUR_CONSUMER_SECRET_HERE"
EOF
docker-compose restart web
```

**ì‹¤ì œ ì˜ˆì‹œ (ë°œê¸‰ë°›ì€ í‚¤ë¡œ ë³€ê²½í•˜ì„¸ìš”):**
```bash
cd /volume1/docker/nas_naver_crawler && cat >> .env << 'EOF'

# SGIS (í†µê³„ì§€ë¦¬ì •ë³´ì„œë¹„ìŠ¤) API - ì—­ì§€ì˜¤ì½”ë”©ìš©
SGIS_CONSUMER_KEY="1fda8e6202ad463d91aa"
SGIS_CONSUMER_SECRET="b2b879daf06c47e8b500"
EOF
docker-compose restart web
```

### ë°©ë²• 2: í…ìŠ¤íŠ¸ ì—ë””í„°ë¡œ ìˆ˜ì •

```bash
# SSHë¡œ NAS ì ‘ì†
ssh your-nas-user@your-nas-ip

# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /volume1/docker/nas_naver_crawler

# .env íŒŒì¼ íŽ¸ì§‘
nano .env
# ë˜ëŠ”
vi .env
```

ë‹¤ìŒ ë‚´ìš©ì„ íŒŒì¼ ëì— ì¶”ê°€:
```bash
# SGIS (í†µê³„ì§€ë¦¬ì •ë³´ì„œë¹„ìŠ¤) API - ì—­ì§€ì˜¤ì½”ë”©ìš©
SGIS_CONSUMER_KEY="YOUR_CONSUMER_KEY_HERE"
SGIS_CONSUMER_SECRET="YOUR_CONSUMER_SECRET_HERE"
```

ì €ìž¥ í›„:
```bash
docker-compose restart web
```

---

## âœ… ì„¤ì • í™•ì¸

### 1. ë¡œê·¸ í™•ì¸
```bash
docker-compose logs -f web
```

ë‹¤ìŒ ë¡œê·¸ê°€ ë‚˜ì˜¤ë©´ ì„±ê³µ:
```
[SGIS Auth] ðŸ”‘ ìƒˆ AccessToken ë°œê¸‰ ì‹œìž‘
[SGIS Auth] âœ… AccessToken ë°œê¸‰ ì„±ê³µ
```

ë‹¤ìŒ ë¡œê·¸ê°€ ë‚˜ì˜¤ë©´ ì‹¤íŒ¨ (í™˜ê²½ ë³€ìˆ˜ ë‹¤ì‹œ í™•ì¸):
```
[SGIS Auth] âŒ ì¸ì¦ ì‹¤íŒ¨: SGIS ì¸ì¦ ì˜¤ë¥˜: ì¸ì¦ì •ë³´ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (ì½”ë“œ: -401)
```

### 2. í¬ë¡¤ë§ í…ŒìŠ¤íŠ¸
ë‹¨ì§€ë¥¼ í¬ë¡¤ë§í•˜ê³  ë¡œê·¸ì—ì„œ ë‹¤ìŒ ë©”ì‹œì§€ í™•ì¸:
```
âœ… Geocoded: ëž˜ë¯¸ì•ˆì•„íŒŒíŠ¸ â†’ ë¶„ë‹¹êµ¬ ì„œí˜„ë™
```

### 3. ìƒì„¸ íŽ˜ì´ì§€ í™•ì¸
ë‹¨ì§€ ìƒì„¸ íŽ˜ì´ì§€ì—ì„œ "ë²•ì •ë™" ì •ë³´ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

## ðŸš¨ ë¬¸ì œ í•´ê²°

### ì¸ì¦ ì‹¤íŒ¨ (-401)
- í™˜ê²½ ë³€ìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
- Docker ì»¨í…Œì´ë„ˆë¥¼ ìž¬ì‹œìž‘í–ˆëŠ”ì§€ í™•ì¸
- SGIS í™ˆíŽ˜ì´ì§€ì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ê°€ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸

### í† í° ë§Œë£Œ (ê¸°ì¡´ í† í°ì´ ë§Œë£Œë¨)
- ìžë™ìœ¼ë¡œ ìž¬ë°œê¸‰ë˜ë¯€ë¡œ ë³„ë„ ì¡°ì¹˜ ë¶ˆí•„ìš”
- ë¡œê·¸ì— `[SGIS Auth] ðŸ”‘ ìƒˆ AccessToken ë°œê¸‰ ì‹œìž‘` ë©”ì‹œì§€ í‘œì‹œë¨

### í• ë‹¹ëŸ‰ ì´ˆê³¼
- SGIS APIëŠ” ì¼ì¼ í˜¸ì¶œ ì œí•œì´ ìžˆì„ ìˆ˜ ìžˆìŒ
- ì œí•œì— ê±¸ë¦¬ë©´ ë‹¤ìŒ ë‚  ìžë™ìœ¼ë¡œ ë³µêµ¬
- ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” 300ms ê°„ê²©ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ ì œí•œ ë°©ì§€

---

## ðŸ“š ì°¸ê³  ìžë£Œ

- **SGIS í™ˆíŽ˜ì´ì§€**: https://sgis.kostat.go.kr/
- **SGIS API ë¬¸ì„œ**: https://sgis.kostat.go.kr/developer/html/newOpenApi/api/dataApi/addressBoundary.html
- **ì—­ì§€ì˜¤ì½”ë”© API**: `rgeocodewgs84` (WGS84 ì¢Œí‘œê³„ â†’ ì£¼ì†Œ ë³€í™˜)

---

## ðŸ’¡ ì¶”ê°€ ì •ë³´

### ì—­ì§€ì˜¤ì½”ë”©ì´ ì‚¬ìš©ë˜ëŠ” ê³³

1. **í¬ë¡¤ë§ ì‹œ ìžë™ ìˆ˜í–‰** (v2.12.2)
   - ì‹ ê·œ í¬ë¡¤ë§ ì‹œ ìžë™ìœ¼ë¡œ ë²•ì •ë™ ì •ë³´ ìˆ˜ì§‘
   - íŒŒì¼: `app/api/crawl/route.ts`

2. **ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸** (v2.12.3)
   - ê¸°ì¡´ ë‹¨ì§€ ì¼ê´„ ì²˜ë¦¬
   - ì‹¤í–‰: `npx tsx scripts/geocode-existing-complexes.ts`

3. **ìƒì„¸ íŽ˜ì´ì§€ ìžë™ ì²˜ë¦¬** (v2.12.3)
   - ë²•ì •ë™ì´ ì—†ìœ¼ë©´ íŽ˜ì´ì§€ ë¡œë“œ ì‹œ ìžë™ ìˆ˜í–‰
   - íŒŒì¼: `app/complex/[complexNo]/page.tsx`

### ì™œ í•„ìš”í•œê°€?

ì‹¤ê±°ëž˜ê°€ ì¡°íšŒ API(ê³µê³µë°ì´í„°í¬í„¸)ëŠ” **ë²•ì •ë™ ì½”ë“œ**ë¥¼ í•„ìˆ˜ë¡œ ìš”êµ¬í•©ë‹ˆë‹¤.
- ë„¤ì´ë²„ APIëŠ” ë²•ì •ë™ ì½”ë“œë¥¼ ì œê³µí•˜ì§€ ì•ŠìŒ
- ì¢Œí‘œ(ìœ„ë„/ê²½ë„)ë§Œ ì œê³µë¨
- SGIS APIë¡œ ì¢Œí‘œ â†’ ë²•ì •ë™ ë³€í™˜ í•„ìš”

---

**ìž‘ì„±ì¼**: 2025-10-26
**ë²„ì „**: v2.12.3
